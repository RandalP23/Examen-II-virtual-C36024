library(tidyverse)
library(readr)
moras <- read_csv("moras.txt")
nrow(moras)
library(tidyverse)
resumen <- moras %>%
summarise(
media.edad = mean(EDAD, na.rm = TRUE),
minimo.edad = min(EDAD, na.rm = TRUE),
maximo.edad = max(EDAD, na.rm = TRUE),
q1.edad = quantile(EDAD, 0.25, na.rm = TRUE),
q3.edad = quantile(EDAD, 0.75, na.rm = TRUE),
media.salario = mean(SALARIO, na.rm = TRUE),
minimo.salario = min(SALARIO, na.rm = TRUE),
maximo.salario = max(SALARIO, na.rm = TRUE),
q1.salario = quantile(SALARIO, 0.25, na.rm = TRUE),
q3.salario = quantile(SALARIO, 0.75, na.rm = TRUE),
)
resumen
moras
moras <- read_csv("moras.xlsx")
moras
library(readxl)
moras <- read_excel("moras.xlsx")
moras
resumen <- moras %>%
summarise(
media.edad = mean(EDAD, na.rm = TRUE),
minimo.edad = min(EDAD, na.rm = TRUE),
maximo.edad = max(EDAD, na.rm = TRUE),
q1.edad = quantile(EDAD, 0.25, na.rm = TRUE),
q3.edad = quantile(EDAD, 0.75, na.rm = TRUE),
media.salario = mean(SALARIO, na.rm = TRUE),
minimo.salario = min(SALARIO, na.rm = TRUE),
maximo.salario = max(SALARIO, na.rm = TRUE),
q1.salario = quantile(SALARIO, 0.25, na.rm = TRUE),
q3.salario = quantile(SALARIO, 0.75, na.rm = TRUE),
)
resumen
promerio.edad = resumen$media.edad
promerio.edad
mean.salario <- mean(moras$SALARIO, na.rm = TRUE)
mean.salario
mean.salario <- mean(moras$SALARIO, na.rm = TRUE)
mean.edad <- mean(moras$EDAD, na.rm = TRUE)
desviacion.salario <- sd(moras$SALARIO, na.rm = TRUE)
desviacion.edad <- sd(moras$EDAD, na.rm = TRUE)
moras <- moras %>%
mutate(
z.salario = (SALARIO - mean.salario) / desviacion.salario
z.edad = (EDAD - mean.edad) / desviacion.edad
moras <- moras %>%
mutate(
z.salario = (SALARIO - mean.salario) / desviacion.salario,
z.edad = (EDAD - mean.edad) / desviacion.edad
)
library(tidyverse)
moras <- moras %>%
mutate(
z.salario = (SALARIO - mean.salario) / desviacion.salario,
z.edad = (EDAD - mean.edad) / desviacion.edad
)
moras <- moras %>%
mutate(
z.salario = (SALARIO - mean.salario) / desviacion.salario,
z.edad = (EDAD - mean.edad) / desviacion.edad
) %>%
mutate(
atatipico.salario = if_else(abs(z.salario) > 1.96, "ATIPICO", "NO ATIPICO"),
atipipico.edad = if_else(abs(z.edad) > 1.96, "ATIPICO", "NO ATIPICO")
)
moras
(tidyverse)
porcentajes.na <- colSums(is.na(moras))
porcentajes.na
View(moras)
moras
library(tidyverse)
library(readxl)
moras <- read_excel("moras.xlsx")
resumen <- moras %>%
summarise(
media.edad = mean(EDAD, na.rm = TRUE),
minimo.edad = min(EDAD, na.rm = TRUE),
maximo.edad = max(EDAD, na.rm = TRUE),
q1.edad = quantile(EDAD, 0.25, na.rm = TRUE),
q3.edad = quantile(EDAD, 0.75, na.rm = TRUE),
media.salario = mean(SALARIO, na.rm = TRUE),
minimo.salario = min(SALARIO, na.rm = TRUE),
maximo.salario = max(SALARIO, na.rm = TRUE),
q1.salario = quantile(SALARIO, 0.25, na.rm = TRUE),
q3.salario = quantile(SALARIO, 0.75, na.rm = TRUE),
)
mean.salario <- mean(moras$SALARIO, na.rm = TRUE)
mean.edad <- mean(moras$EDAD, na.rm = TRUE)
desviacion.salario <- sd(moras$SALARIO, na.rm = TRUE)
desviacion.edad <- sd(moras$EDAD, na.rm = TRUE)
moras <- moras %>%
mutate(
Z.SALARIO = (SALARIO - mean.salario) / desviacion.salario,
Z.EDAD = (EDAD - mean.edad) / desviacion.edad
) %>%
mutate(
ATIPICO.SALARIO = if_else(abs(Z.SALARIO) > 1.96, "ATIPICO", "NO ATIPICO"),
ATIPICO.EDAD = if_else(abs(Z.EDAD) > 1.96, "ATIPICO", "NO ATIPICO")
)
porcentajes.na <- data.frame(
dato = names(moras)
faltante = colSums(is.na(moras))
porcentajes.na <- data.frame(
dato = names(moras),
faltante = colSums(is.na(moras))
) %>%
mutate(
porcentajes.na = (faltante/5000)* 100
)
porcentajes.na
library(tidyverse)
porcentajes.na
moda.aseguramiento <- moras %>%
group_by(TIPO_ASEGURAMIENTO) %>%
summarise( contador = n()) %>%
arrange(desc(contador)) %>%
head(1)
moda.aseguramiento
moda.aseg <- "ASALARIADO"
moras <- moras %>%
mutate(
EDAD = if_else(is.na(EDAD), mean.edad, Edad),
SALARIO = if_else(is.na(SALARIO), mean.salario, SALARIO),
TIPO_ASEGURAMIENTO = if_else(is.na(TIPO_ASEGURAMIENTO), moda.aseg, TIPO_ASEGURAMIENTO)
)
moras <- moras %>%
mutate(
EDAD = if_else(is.na(EDAD), mean.edad, EDAD),
SALARIO = if_else(is.na(SALARIO), mean.salario, SALARIO),
TIPO_ASEGURAMIENTO = if_else(is.na(TIPO_ASEGURAMIENTO), moda.aseg, TIPO_ASEGURAMIENTO)
)
moda.aseguramiento
moda.aseg <- moda.aseguramiento$TIPO_ASEGURAMIENTO
moda.aseg
library(tidyverse)
moras %>%
group_by(SEXO) %>%
summarise(contador = n()) %>%
ggplot(aes(x = SEXO, y = contador)) +
geom_bar(stat = "identity", fill = "steelblue") +
theme_minimal()
theme_minimal()
graf.cantidadporsexo <- moras %>%
group_by(SEXO) %>%
summarise(contador = n()) %>%
ggplot(aes(x = SEXO, y = contador)) +
geom_bar(stat = "identity", fill = "steelblue") +
labs(title = "Cantidad por sexo", x = "Sexo", y = "Cantidad")+
theme_minimal()
graf.cantidadporsexo
graf.cantidadporaseguramientp <- moras %>%
group_by(TIPO_ASEGURAMIENTO) %>%
summarise(contador = n()) %>%
ggplot(aes(x = TIPO_ASEGURAMIENTO, y = contador)) +
geom_bar(stat = "identity", fill = "steelblue") +
labs(title = "Cantidad por aseguramiento", x = "Aseguramiento", y = "Cantidad")+
theme_minimal()
graf.cantidadporaseguramientp
graf.cantidadporaseguramientp <- moras %>%
group_by(TIPO_ASEGURAMIENTO) %>%
summarise(contador = n()) %>%
ggplot(aes(x = TIPO_ASEGURAMIENTO, y = contador)) +
geom_bar(stat = "identity", fill = "steelblue") +
labs(title = "Cantidad por aseguramiento", x = "Aseguramiento", y = "Cantidad")+
theme_minimal()+
theme(axis.text.x = element_text(angle = 45, hjust = 1))
graf.cantidadporaseguramientp
graf.cantidadporaseguramientp <- moras %>%
group_by(TIPO_ASEGURAMIENTO) %>%
summarise(contador = n()) %>%
ggplot(aes(x = TIPO_ASEGURAMIENTO, y = contador)) +
geom_bar(stat = "identity", fill = "steelblue") +
labs(title = "Cantidad por aseguramiento", x = "Aseguramiento", y = "Cantidad")+
theme_minimal()+
theme(axis.text.x = element_text(angle = 25, hjust = 1))
graf.cantidadporaseguramientp
resumen
graf.cantidadporsector <- moras %>%
group_by(SECTOR) %>%
summarise(contador = n()) %>%
ggplot(aes(x = SECTOR, y = contador)) +
geom_bar(stat = "identity", fill = "steelblue") +
labs(title = "Cantidad por sector", x = "Sector", y = "Cantidad")+
theme_minimal()
graf.cantidadporsector
View(moras)
moras
graf.cantidadporextranjeros<- moras %>%
group_by(INDICADOR.EXTRANJERO) %>%
summarise(contador = n()) %>%
ggplot(aes(x = SECTOR, y = contador)) +
geom_bar(stat = "identity", fill = "steelblue") +
labs(title = "Cantidad por extranjeros", x = "Extranjero", y = "Cantidad")+
theme_minimal()
graf.cantidadporextranjeros
graf.cantidadporextranjeros<- moras %>%
group_by(INDICADOR.EXTRANJERO) %>%
summarise(contador = n()) %>%
ggplot(aes(x = INDICADOR.EXTRANJERO, y = contador)) +
geom_bar(stat = "identity", fill = "steelblue") +
labs(title = "Cantidad por extranjeros", x = "Extranjero", y = "Cantidad")+
theme_minimal()
graf.cantidadporextranjeros
moras
graf.cantidadporactividad <- moras %>%
group_by(INDICADOR_ACTIVO) %>%
summarise(contador = n()) %>%
ggplot(aes(x = INDICADOR_ACTIVO, y = contador)) +
geom_bar(stat = "identity", fill = "steelblue") +
labs(title = "Cantidad por actividad", x = "Activo", y = "Cantidad")+
theme_minimal()
graf.cantidadporactividad
graf.cantidadpormorosidad <- moras %>%
group_by(INDICADOR_MOROSO) %>%
summarise(contador = n()) %>%
ggplot(aes(x = INDICADOR_MOROSO, y = contador)) +
geom_bar(stat = "identity", fill = "steelblue") +
labs(title = "Cantidad por morosidad", x = "Moroso", y = "Cantidad")+
theme_minimal()
graf.cantidadpormorosidad
graf.cantidadporaseguramientp <- moras %>%
group_by(TIPO_ASEGURAMIENTO) %>%
summarise(contador = n()) %>%
ggplot(aes(x = TIPO_ASEGURAMIENTO, y = contador)) +
coord_flip()+
geom_bar(stat = "identity", fill = "steelblue") +
labs(title = "Cantidad por aseguramiento", x = "Aseguramiento", y = "Cantidad")+
theme_minimal()+
theme(axis.text.x = element_text(angle = 25, hjust = 1))
graf.cantidadporaseguramientp
graf.cantidadporsexo
graf.cantidadporaseguramiento <- moras %>%
group_by(TIPO_ASEGURAMIENTO) %>%
summarise(contador = n()) %>%
ggplot(aes(x = TIPO_ASEGURAMIENTO, y = contador)) +
coord_flip()+
geom_bar(stat = "identity", fill = "steelblue") +
labs(title = "Cantidad por aseguramiento", x = "Aseguramiento", y = "Cantidad")+
theme_minimal()+
theme(axis.text.x = element_text(angle = 25, hjust = 1))
tidyverse
library(tidyverse)
graf.porcentajemorosidad <- function(data, categoria){
data %>%
group_by(.data[[categoria]]) %>%
summarise(
cantidad = n(),
morosos = sum(INDICADOR_MOROSO == "SI"),
porcentaje = morosos / cantidad
) %>%
ggplot(aes(x = .data[[categoria]], y = porcentaje))+
geom_bar(stat = "identify", fill = darkred)+
labs(title = paste("% de morosos por", categoria), x = categoria, y = "Porcentaje")
}
data %>%
group_by(.data[[categoria]]) %>%
summarise(
cantidad = n(),
morosos = sum(INDICADOR_MOROSO == "SI"),
porcentaje = morosos / cantidad
) %>%
ggplot(aes(x = .data[[categoria]], y = porcentaje))+
geom_bar(stat = "identify", fill = "steelblue")+
labs(title = paste("% de morosos por", categoria), x = categoria, y = "Porcentaje")
library(tidyverse)
data %>%
group_by(.data[[categoria]]) %>%
summarise(
cantidad = n(),
morosos = sum(INDICADOR_MOROSO == "SI"),
porcentaje = morosos / cantidad
) %>%
ggplot(aes(x = .data[[categoria]], y = porcentaje))+
geom_bar(stat = "identify", fill = "steelblue")+
labs(title = paste("% de morosos por", categoria), x = categoria, y = "Porcentaje")
graf.porcentajemorosidad <- function(data, categoria){
data %>%
group_by(.data[[categoria]]) %>%
summarise(
cantidad = n(),
morosos = sum(INDICADOR_MOROSO == "SI"),
porcentaje = morosos / cantidad
) %>%
ggplot(aes(x = .data[[categoria]], y = porcentaje))+
geom_bar(stat = "identify", fill = "steelblue")+
labs(title = paste("% de morosos por", categoria), x = categoria, y = "Porcentaje")
}
graf.porcentajemorosidad(moras, SEXO)
graf.porcentajemorosidad(moras, "SEXO")
graf.porcentajemorosidad <- function(data, categoria){
data %>%
group_by(.data[[categoria]]) %>%
summarise(
cantidad = n(),
morosos = sum(INDICADOR_MOROSO == "SI"),
porcentaje = morosos / cantidad
) %>%
ggplot(aes(x = .data[[categoria]], y = porcentaje))+
geom_bar(stat = "identity", fill = "steelblue")+
labs(title = paste("% de morosos por", categoria), x = categoria, y = "Porcentaje")+
geom_text(aes(label = percent(porcentaje, accuracy = 0.1)),
vjust = -0.5,
size = 4) +
scale_y_continuous(labels = percent_format(accuracy = 1),
limits = c(0, max(datos$porcentaje)*1.15)) +
theme_minimal()
}
graf.porcentajemorosidad(moras, "SEXO")
graf.porcentajemorosidad <- function(data, categoria){
data %>%
group_by(.data[[categoria]]) %>%
summarise(
cantidad = n(),
morosos = sum(INDICADOR_MOROSO == "SI"),
porcentaje = morosos / cantidad
) %>%
ggplot(aes(x = .data[[categoria]], y = porcentaje))+
geom_bar(stat = "identity", fill = "steelblue")+
labs(title = paste("% de morosos por", categoria), x = categoria, y = "Porcentaje") +
theme_minimal()
}
graf.porcentajemorosidad(moras, "SEXO")
graf.porcentajemorosidad(moras, "TIPO_ASEGURAMIENTO")
library(scales)
ggplot(datos_aseg, aes(x = porcentaje, y = TIPO_ASEGURAMIENTO)) +
geom_col(fill = "steelblue") +
geom_text(aes(label = percent(porcentaje, accuracy = 0.1)),
hjust = -0.1, size = 4) +
scale_x_continuous(labels = percent_format(accuracy = 1),
limits = c(0, max(datos_aseg$porcentaje) * 1.15)) +
labs(title = "% de morosos por tipo de aseguramiento",x = "Porcentaje",y = "Tipo de aseguramiento"
) +
theme_minimal()
ggplot(datos_aseg, aes(x = porcentaje, y = TIPO_ASEGURAMIENTO)) +
geom_col(fill = "steelblue") +
geom_text(aes(label = percent(porcentaje, accuracy = 0.1)),
hjust = -0.1, size = 4)+
labs(title = "% de morosos por tipo de aseguramiento",x = "Porcentaje",y = "Tipo de aseguramiento"
) +
theme_minimal()
porcentaje.morosos.aseguramiento <- moras %>%
group_by(TIPO_ASEGURAMIENTO) %>%
summarise(
cantidad = n(),
morosos = sum(INDICADOR_MOROSO == "SI"),
porcentaje = morosos / cantidad
)+
ggplot(datos_aseg, aes(x = porcentaje, y = TIPO_ASEGURAMIENTO)) +
geom_col(fill = "steelblue") +
geom_text(aes(label = percent(porcentaje, accuracy = 0.1)),
hjust = -0.1, size = 4)+
labs(title = "% de morosos por tipo de aseguramiento",x = "Porcentaje",y = "Tipo de aseguramiento"
) +
theme_minimal()
distribucion.aseg <- moras %>%
group_by(TIPO_ASEGURAMIENTO) %>%
summarise(
cantidad = n(),
morosos = sum(INDICADOR_MOROSO == "SI"),
porcentaje = morosos / cantidad
)
ggplot(distribucion.aseg, aes(x = porcentaje, y = TIPO_ASEGURAMIENTO)) +
geom_col(fill = "steelblue") +
geom_text(aes(label = percent(porcentaje, accuracy = 0.1)),
hjust = -0.1, size = 4)+
labs(title = "% de morosos por tipo de aseguramiento",x = "Porcentaje",y = "Tipo de aseguramiento"
) +
theme_minimal()
ggplot(distribucion.aseg, aes(x = porcentaje, y = TIPO_ASEGURAMIENTO)) +
geom_col(fill = "steelblue") +
geom_text(aes(label = percent(porcentaje, accuracy = 0.1)),
hjust = -0.1, size = 4) +
scale_x_continuous(labels = percent_format(accuracy = 1),
limits = c(0, max(distribucion.aseg$porcentaje) * 1.15)) +
labs(
title = "% de morosos por tipo de aseguramiento",
x = "Porcentaje",
y = "Tipo de aseguramiento"
) +
theme_minimal()
graf.porcentajemorosidad(moras, "INDICADOR_ACTIVO")
graf.porcentajemorosidad <- function(data, categoria){
data %>%
group_by(.data[[categoria]]) %>%
summarise(
cantidad = n(),
morosos = sum(INDICADOR_MOROSO == "SI"),
porcentaje = morosos / cantidad
) %>%
ggplot(aes(x = .data[[categoria]], y = porcentaje))+
geom_bar(stat = "identity", fill = "steelblue")+
labs(title = paste("% de morosos por", categoria), x = categoria, y = "Porcentaje") +
theme_minimal()+
}
graf.porcentajemorosidad <- function(data, categoria){
data %>%
group_by(.data[[categoria]]) %>%
summarise(
cantidad = n(),
morosos = sum(INDICADOR_MOROSO == "SI"),
porcentaje = morosos / cantidad
)
geom_text(aes(label = percent(porcentaje, accuracy = 0.1)), vjust = -0.5, size = 4) +
scale_y_continuous(labels = percent_format(accuracy = 1),
limits = c(0, max(datos$porcentaje)*1.15)) +
labs( title = paste("% de morosos por", categoria), x = categoria, y = "Porcentaje"
) +
theme_minimal()
}
graf.porcentajemorosidad(moras, "SEXO")
graf.porcentajemorosidad <- function(data, categoria){
data %>%
group_by(.data[[categoria]]) %>%
summarise(
cantidad = n(),
morosos = sum(INDICADOR_MOROSO == "SI"),
porcentaje = morosos / cantidad
) %>% geom_text(aes(label = percent(porcentaje, accuracy = 0.1)), vjust = -0.5, size = 4) +
scale_y_continuous(labels = percent_format(accuracy = 1),
limits = c(0, max(datos$porcentaje)*1.15)) +
labs( title = paste("% de morosos por", categoria), x = categoria, y = "Porcentaje"
) +
theme_minimal()
}
graf.porcentajemorosidad(moras, "SEXO")
graf.porcentajemorosidad <- function(data, categoria){
datos <- data %>%
group_by(.data[[categoria]]) %>%
summarise(
cantidad   = n(),
morosos    = sum(INDICADOR_MOROSO == "SI"),
porcentaje = morosos / cantidad
)
ggplot(datos, aes(x = .data[[categoria]], y = porcentaje)) +
geom_col(fill = "steelblue") +
geom_text(aes(label = percent(porcentaje, accuracy = 0.1)),
vjust = -0.5, size = 4) +
scale_y_continuous(labels = percent_format(accuracy = 1),
limits = c(0, max(datos$porcentaje) * 1.15)) +
labs( title = paste("% de morosos por", categoria), x = categoria,y = "Porcentaje"
) +
theme_minimal()
}
graf.porcentajemorosidad(moras, "SEXO")
ggplot(distribucion.aseg, aes(x = porcentaje, y = TIPO_ASEGURAMIENTO)) +
geom_col(fill = "steelblue") +
geom_text(aes(label = percent(porcentaje, accuracy = 0.1)),
hjust = -0.1, size = 4) +
scale_x_continuous(labels = percent_format(accuracy = 1),
limits = c(0, max(distribucion.aseg$porcentaje) * 1.15)) +
labs(title = "% de morosos por tipo de aseguramiento",x = "Porcentaje",y = "Tipo de aseguramiento"
) +
theme_minimal()
graf.porcentajemorosidad(moras, "SEXO")
graf.porcentajemorosidad(moras, "INDICADOR_ACTIVO")
graf.porcentajemorosidad(moras, "INDICADOR.EXTRANJERO")
graf.porcentajemorosidad(moras, "SECTOR")
ggplot(distribucion.aseg, aes(x = porcentaje, y = TIPO_ASEGURAMIENTO)) +
geom_col(fill = "steelblue") +
geom_text(aes(label = percent(porcentaje, accuracy = 0.1)),
hjust = -0.1, size = 4) +
scale_x_continuous(labels = percent_format(accuracy = 1),
limits = c(0, max(distribucion.aseg$porcentaje) * 1.15)) +
labs(title = "% de morosos por tipo de aseguramiento",x = "Porcentaje",y = "Tipo de aseguramiento"
) +
theme_minimal()

geom_bar(stat = "identity", fill = "steelblue")+
labs(title = paste("% de morosos por", categoria), x = categoria, y = "Porcentaje")+
geom_text(aes(label = percent(porcentaje, accuracy = 0.1)),
vjust = -0.5,
size = 4) +
scale_y_continuous(labels = percent_format(accuracy = 1),
limits = c(0, max(datos$porcentaje)*1.15)) +
theme_minimal()
}
graf.porcentajemorosidad(moras, "SEXO")
graf.porcentajemorosidad <- function(data, categoria){
data %>%
group_by(.data[[categoria]]) %>%
summarise(
cantidad = n(),
morosos = sum(INDICADOR_MOROSO == "SI"),
porcentaje = morosos / cantidad
) %>%
ggplot(aes(x = .data[[categoria]], y = porcentaje))+
geom_bar(stat = "identity", fill = "steelblue")+
labs(title = paste("% de morosos por", categoria), x = categoria, y = "Porcentaje") +
theme_minimal()
}
graf.porcentajemorosidad(moras, "SEXO")
graf.porcentajemorosidad(moras, "TIPO_ASEGURAMIENTO")
library(scales)
ggplot(datos_aseg, aes(x = porcentaje, y = TIPO_ASEGURAMIENTO)) +
geom_col(fill = "steelblue") +
geom_text(aes(label = percent(porcentaje, accuracy = 0.1)),
hjust = -0.1, size = 4) +
scale_x_continuous(labels = percent_format(accuracy = 1),
limits = c(0, max(datos_aseg$porcentaje) * 1.15)) +
labs(title = "% de morosos por tipo de aseguramiento",x = "Porcentaje",y = "Tipo de aseguramiento"
) +
theme_minimal()
ggplot(datos_aseg, aes(x = porcentaje, y = TIPO_ASEGURAMIENTO)) +
geom_col(fill = "steelblue") +
geom_text(aes(label = percent(porcentaje, accuracy = 0.1)),
hjust = -0.1, size = 4)+
labs(title = "% de morosos por tipo de aseguramiento",x = "Porcentaje",y = "Tipo de aseguramiento"
) +
theme_minimal()
porcentaje.morosos.aseguramiento <- moras %>%
group_by(TIPO_ASEGURAMIENTO) %>%
summarise(
cantidad = n(),
morosos = sum(INDICADOR_MOROSO == "SI"),
porcentaje = morosos / cantidad
)+
ggplot(datos_aseg, aes(x = porcentaje, y = TIPO_ASEGURAMIENTO)) +
geom_col(fill = "steelblue") +
geom_text(aes(label = percent(porcentaje, accuracy = 0.1)),
hjust = -0.1, size = 4)+
labs(title = "% de morosos por tipo de aseguramiento",x = "Porcentaje",y = "Tipo de aseguramiento"
) +
theme_minimal()
distribucion.aseg <- moras %>%
group_by(TIPO_ASEGURAMIENTO) %>%
summarise(
cantidad = n(),
morosos = sum(INDICADOR_MOROSO == "SI"),
porcentaje = morosos / cantidad
)
ggplot(distribucion.aseg, aes(x = porcentaje, y = TIPO_ASEGURAMIENTO)) +
geom_col(fill = "steelblue") +
geom_text(aes(label = percent(porcentaje, accuracy = 0.1)),
hjust = -0.1, size = 4)+
labs(title = "% de morosos por tipo de aseguramiento",x = "Porcentaje",y = "Tipo de aseguramiento"
) +
theme_minimal()
ggplot(distribucion.aseg, aes(x = porcentaje, y = TIPO_ASEGURAMIENTO)) +
geom_col(fill = "steelblue") +
geom_text(aes(label = percent(porcentaje, accuracy = 0.1)),
hjust = -0.1, size = 4) +
scale_x_continuous(labels = percent_format(accuracy = 1),
limits = c(0, max(distribucion.aseg$porcentaje) * 1.15)) +
labs(
title = "% de morosos por tipo de aseguramiento",
x = "Porcentaje",
y = "Tipo de aseguramiento"
) +
theme_minimal()
graf.porcentajemorosidad(moras, "INDICADOR_ACTIVO")
graf.porcentajemorosidad <- function(data, categoria){
data %>%
group_by(.data[[categoria]]) %>%
summarise(
cantidad = n(),
morosos = sum(INDICADOR_MOROSO == "SI"),
porcentaje = morosos / cantidad
) %>%
ggplot(aes(x = .data[[categoria]], y = porcentaje))+
geom_bar(stat = "identity", fill = "steelblue")+
labs(title = paste("% de morosos por", categoria), x = categoria, y = "Porcentaje") +
theme_minimal()+
}
graf.porcentajemorosidad <- function(data, categoria){
data %>%
group_by(.data[[categoria]]) %>%
summarise(
cantidad = n(),
morosos = sum(INDICADOR_MOROSO == "SI"),
porcentaje = morosos / cantidad
)
geom_text(aes(label = percent(porcentaje, accuracy = 0.1)), vjust = -0.5, size = 4) +
scale_y_continuous(labels = percent_format(accuracy = 1),
limits = c(0, max(datos$porcentaje)*1.15)) +
labs( title = paste("% de morosos por", categoria), x = categoria, y = "Porcentaje"
) +
theme_minimal()
}
graf.porcentajemorosidad(moras, "SEXO")
graf.porcentajemorosidad <- function(data, categoria){
data %>%
group_by(.data[[categoria]]) %>%
summarise(
cantidad = n(),
morosos = sum(INDICADOR_MOROSO == "SI"),
porcentaje = morosos / cantidad
) %>% geom_text(aes(label = percent(porcentaje, accuracy = 0.1)), vjust = -0.5, size = 4) +
scale_y_continuous(labels = percent_format(accuracy = 1),
limits = c(0, max(datos$porcentaje)*1.15)) +
labs( title = paste("% de morosos por", categoria), x = categoria, y = "Porcentaje"
) +
theme_minimal()
}
graf.porcentajemorosidad(moras, "SEXO")
graf.porcentajemorosidad <- function(data, categoria){
datos <- data %>%
group_by(.data[[categoria]]) %>%
summarise(
cantidad   = n(),
morosos    = sum(INDICADOR_MOROSO == "SI"),
porcentaje = morosos / cantidad
)
ggplot(datos, aes(x = .data[[categoria]], y = porcentaje)) +
geom_col(fill = "steelblue") +
geom_text(aes(label = percent(porcentaje, accuracy = 0.1)),
vjust = -0.5, size = 4) +
scale_y_continuous(labels = percent_format(accuracy = 1),
limits = c(0, max(datos$porcentaje) * 1.15)) +
labs( title = paste("% de morosos por", categoria), x = categoria,y = "Porcentaje"
) +
theme_minimal()
}
graf.porcentajemorosidad(moras, "SEXO")
ggplot(distribucion.aseg, aes(x = porcentaje, y = TIPO_ASEGURAMIENTO)) +
geom_col(fill = "steelblue") +
geom_text(aes(label = percent(porcentaje, accuracy = 0.1)),
hjust = -0.1, size = 4) +
scale_x_continuous(labels = percent_format(accuracy = 1),
limits = c(0, max(distribucion.aseg$porcentaje) * 1.15)) +
labs(title = "% de morosos por tipo de aseguramiento",x = "Porcentaje",y = "Tipo de aseguramiento"
) +
theme_minimal()
graf.porcentajemorosidad(moras, "SEXO")
graf.porcentajemorosidad(moras, "INDICADOR_ACTIVO")
graf.porcentajemorosidad(moras, "INDICADOR.EXTRANJERO")
graf.porcentajemorosidad(moras, "SECTOR")
ggplot(distribucion.aseg, aes(x = porcentaje, y = TIPO_ASEGURAMIENTO)) +
geom_col(fill = "steelblue") +
geom_text(aes(label = percent(porcentaje, accuracy = 0.1)),
hjust = -0.1, size = 4) +
scale_x_continuous(labels = percent_format(accuracy = 1),
limits = c(0, max(distribucion.aseg$porcentaje) * 1.15)) +
labs(title = "% de morosos por tipo de aseguramiento",x = "Porcentaje",y = "Tipo de aseguramiento"
) +
theme_minimal()
moras
ggplot(moras, aes(x = INDICADOR_MOROSO, y = SALARIO, fill = INDICADOR_MOROSO)) +
geom_boxplot() +
labs(
title = "Distribución del salario según morosidad",
x = "Moroso",
y = "Salario"
) +
theme_minimal() +
theme(legend.position = "none")
library(tidyverse)
ggplot(moras, aes(x = INDICADOR_MOROSO, y = SALARIO, fill = INDICADOR_MOROSO)) +
geom_boxplot() +
labs(
title = "Distribución del salario según morosidad",
x = "Moroso",
y = "Salario"
) +
theme_minimal() +
theme(legend.position = "none")
resumen
moras <- moras %>%
mutate(
RANGO.EDAD = case_when(
EDAD >= 14 & EDAD <= 24 ~ "14-24",
EDAD >= 25 & EDAD <= 34 ~ "25-34",
EDAD >= 35 & EDAD <= 44 ~ "35-44",
EDAD >= 45 & EDAD <= 54 ~ "45-54",
EDAD >= 55 & EDAD <= 64 ~ "55-64",
EDAD >= 65              ~ "65+",
TRUE ~ NA_character_
)
)
moras
moras <- moras %>%
mutate(
RANGO_SALARIO = case_when(
SALARIO >= 0       & SALARIO < 200000  ~ "0-200k",
SALARIO >= 200000  & SALARIO < 400000  ~ "200k-400k",
SALARIO >= 400000  & SALARIO < 800000  ~ "400k-800k",
SALARIO >= 800000  & SALARIO < 1500000 ~ "800k-1.5M",
SALARIO >= 1500000 & SALARIO < 3000000 ~ "1.5M-3M",
SALARIO >= 3000000                     ~ "3M+",
TRUE ~ NA_character_
)
)
edad.totales <- moras %>%
group_by(RANGO.EDAD, INDICADOR_MOROSO) %>%
summarise(cantidad = n(), .groups = "drop")
edad.totales
edad.totales <- moras %>%
group_by(RANGO.EDAD, INDICADOR_MOROSO) %>%
summarise(cantidad = n())
edad.totales <- moras %>%
group_by(RANGO.EDAD, INDICADOR_MOROSO) %>%
summarise(cantidad = n(), .groups = "drop")
edad.totales
ggplot(edad_totales, aes(x = RANGO_EDAD, y = cantidad, fill = INDICADOR_MOROSO)) +
geom_col(position = "dodge") +
labs(
title = "Cantidad de morosos y no morosos por rango de edad",
x = "Rango de edad",
y = "Cantidad",
fill = "Moroso"
) +
scale_fill_manual(values = c("SI" = "firebrick", "NO" = "steelblue")) +
theme_minimal()
ggplot(edad.totales, aes(x = RANGO,EDAD, y = cantidad, fill = INDICADOR_MOROSO)) +
geom_col(position = "dodge") +
labs(
title = "Cantidad de morosos y no morosos por rango de edad",
x = "Rango de edad",
y = "Cantidad",
fill = "Moroso"
) +
scale_fill_manual(values = c("SI" = "firebrick", "NO" = "steelblue")) +
theme_minimal()
ggplot(edad.totales, aes(x = RANGO.EDAD, y = cantidad, fill = INDICADOR_MOROSO)) +
geom_col(position = "dodge") +
labs(
title = "Cantidad de morosos y no morosos por rango de edad",
x = "Rango de edad",
y = "Cantidad",
fill = "Moroso"
) +
scale_fill_manual(values = c("SI" = "firebrick", "NO" = "steelblue")) +
theme_minimal()
ggplot(edad.totales, aes(x = RANGO.EDAD, y = cantidad, fill = INDICADOR_MOROSO)) +
geom_col(position = "dodge") +
labs(
title = "Cantidad de morosos y no morosos por rango de edad", x = "Rango de edad", y = "Cantidad",
fill = "Moroso"
) +
scale_fill_manual(values = c("SI" = "#D6A3F0", "NO" = "steelblue")) +
theme_minimal()
ggplot(edad.totales, aes(x = RANGO.EDAD, y = cantidad, fill = INDICADOR_MOROSO)) +
geom_col(position = "dodge") +
labs(
title = "Cantidad de morosos y no morosos por rango de edad", x = "Rango de edad", y = "Cantidad",
fill = "Moroso"
) +
scale_fill_manual(values = c("SI" = "#D6A3F0", "NO" = "#309C58")) +
theme_minimal()
ggplot(edad.totales, aes(x = RANGO.EDAD, y = cantidad, fill = INDICADOR_MOROSO)) +
geom_col(position = "dodge") +
labs(
title = "Cantidad de morosos y no morosos por rango de edad", x = "Rango de edad", y = "Cantidad",
fill = "Moroso"
) +
scale_fill_manual(values = c("SI" = "#B8291D", "NO" = "#309C58")) +
theme_minimal()
salarios.totales <- moras %>%
group_by(RANGO_SALARIO, INDICADOR_MOROSO) %>%
summarise(cantidad = n(), .groups = "drop")
ggplot(salarios.totales, aes(x = RANGO_SALARIO, y = cantidad, fill = INDICADOR_MOROSO)) +
geom_col(position = "dodge") +
labs(
title = "Cantidad de morosos y no morosos por rango salarial", x = "Rango salarial", y = "Cantidad",
fill = "Moroso"
) +
scale_fill_manual(values = c("SI" = "#B8291D", "NO" = "#309C58")) +
theme_minimal()
#| eval: false
library(rpart)
library(rpart.plot)
install.packages("rpart.plot")
#| eval: false
library(rpart)
library(rpart.plot)
tree <- rpart(moras$INDICADOR_MOROSO~., data = moras)
rpart.plot(tree)
moras <- moras %>%
mutate(
TIPO_ASEGURAMIENTO_ABRE = case_when(
TIPO_ASEGURAMIENTO == "ASALARIADO" ~ "ASAL",
TIPO_ASEGURAMIENTO == "PENSIONADOS EN SU PROPIO SISTEMA" ~ "PENPS",
TIPO_ASEGURAMIENTO == "ASEGURADO VOLUNTARIO" ~ "VOL",
TIPO_ASEGURAMIENTO == "TRABAJADOR INDEPENDIENTE" ~ "INDEP",
TIPO_ASEGURAMIENTO == "CONVENIOS ESPECIALES DE TRABAJADORES INDEPENDIENTES" ~ "CONV-TI",
TIPO_ASEGURAMIENTO == "CONVENIOS ESPECIALES DE ASEGURADOS VOLUNTARIOS" ~ "CONV-VOL",
TRUE ~ "OTRO"
)
)
library(tidyverse)
moras <- moras %>%
mutate(
TIPO_ASEGURAMIENTO_ABRE = case_when(
TIPO_ASEGURAMIENTO == "ASALARIADO" ~ "ASAL",
TIPO_ASEGURAMIENTO == "PENSIONADOS EN SU PROPIO SISTEMA" ~ "PENPS",
TIPO_ASEGURAMIENTO == "ASEGURADO VOLUNTARIO" ~ "VOL",
TIPO_ASEGURAMIENTO == "TRABAJADOR INDEPENDIENTE" ~ "INDEP",
TIPO_ASEGURAMIENTO == "CONVENIOS ESPECIALES DE TRABAJADORES INDEPENDIENTES" ~ "CONV-TI",
TIPO_ASEGURAMIENTO == "CONVENIOS ESPECIALES DE ASEGURADOS VOLUNTARIOS" ~ "CONV-VOL",
TRUE ~ "OTRO"
)
)
moras <- moras %>%
mutate(
TIPO_ASEGURAMIENTO_ABRE = case_when(
TIPO_ASEGURAMIENTO == "ASALARIADO" ~ "ASAL",
TIPO_ASEGURAMIENTO == "PENSIONADOS EN SU PROPIO SISTEMA" ~ "PENPS",
TIPO_ASEGURAMIENTO == "ASEGURADO VOLUNTARIO" ~ "VOL",
TIPO_ASEGURAMIENTO == "TRABAJADOR INDEPENDIENTE" ~ "INDEP",
TIPO_ASEGURAMIENTO == "CONVENIOS ESPECIALES DE TRABAJADORES INDEPENDIENTES" ~ "CONV-TI",
TIPO_ASEGURAMIENTO == "CONVENIOS ESPECIALES DE ASEGURADOS VOLUNTARIOS" ~ "CONV-VOL",
TRUE ~ "OTRO"
)
)%>%
mutate(
INDICADOR_MOROSO      = factor(INDICADOR_MOROSO),
SEXO                  = factor(SEXO),
SECTOR                = factor(SECTOR),
INDICADOR_ACTIVO      = factor(INDICADOR_ACTIVO),
INDICADOR_EXTRANJERO  = factor(INDICADOR_EXTRANJERO),
TIPO_ASEGURAMIENTO_ABRE = factor(TIPO_ASEGURAMIENTO_ABRE)
)
moras <- moras %>%
mutate(
TIPO_ASEGURAMIENTO_ABRE = case_when(
TIPO_ASEGURAMIENTO == "ASALARIADO" ~ "ASAL",
TIPO_ASEGURAMIENTO == "PENSIONADOS EN SU PROPIO SISTEMA" ~ "PENPS",
TIPO_ASEGURAMIENTO == "ASEGURADO VOLUNTARIO" ~ "VOL",
TIPO_ASEGURAMIENTO == "TRABAJADOR INDEPENDIENTE" ~ "INDEP",
TIPO_ASEGURAMIENTO == "CONVENIOS ESPECIALES DE TRABAJADORES INDEPENDIENTES" ~ "CONV-TI",
TIPO_ASEGURAMIENTO == "CONVENIOS ESPECIALES DE ASEGURADOS VOLUNTARIOS" ~ "CONV-VOL",
TRUE ~ "OTRO"
)
)%>%
mutate(
INDICADOR_MOROSO      = factor(INDICADOR_MOROSO),
SEXO                  = factor(SEXO),
SECTOR                = factor(SECTOR),
INDICADOR_ACTIVO      = factor(INDICADOR_ACTIVO),
INDICADOR.EXTRANJERO  = factor(INDICADOR.EXTRANJERO),
TIPO_ASEGURAMIENTO_ABRE = factor(TIPO_ASEGURAMIENTO_ABRE)
)
tree <- rpart(INDICADOR_MOROSO~., data = moras)
rpart.plot(tree)
tree <- rpart(INDICADOR_MOROSO~., data = moras)
rpart.plot(tree)
tree <- rpart(INDICADOR_MOROSO~., data = moras)
rpart.plot(tree)
moras.arbol <- moras %>%
mutate(
TIPO_ASEGURAMIENTO_ABRE = case_when(
TIPO_ASEGURAMIENTO == "ASALARIADO" ~ "ASAL",
TIPO_ASEGURAMIENTO == "PENSIONADOS EN SU PROPIO SISTEMA" ~ "PENPS",
TIPO_ASEGURAMIENTO == "ASEGURADO VOLUNTARIO" ~ "VOL",
TIPO_ASEGURAMIENTO == "TRABAJADOR INDEPENDIENTE" ~ "INDEP",
TIPO_ASEGURAMIENTO == "CONVENIOS ESPECIALES DE TRABAJADORES INDEPENDIENTES" ~ "CONV-TI",
TIPO_ASEGURAMIENTO == "CONVENIOS ESPECIALES DE ASEGURADOS VOLUNTARIOS" ~ "CONV-VOL",
TRUE ~ "OTRO"
)
)%>%
mutate(
INDICADOR_MOROSO      = factor(INDICADOR_MOROSO),
SEXO                  = factor(SEXO),
SECTOR                = factor(SECTOR),
INDICADOR_ACTIVO      = factor(INDICADOR_ACTIVO),
INDICADOR.EXTRANJERO  = factor(INDICADOR.EXTRANJERO),
TIPO_ASEGURAMIENTO_ABRE = factor(TIPO_ASEGURAMIENTO_ABRE)
) %>%
select(INDICADOR_MOROSO,          # variable objetivo
SEXO,
SECTOR,
INDICADOR_ACTIVO,
INDICADOR.EXTRANJERO,
TIPO_ASEGURAMIENTO_ABRE,
EDAD_IMPUTADA,
SALARIO_IMPUTAD)
moras.arbol <- moras %>%
mutate(
TIPO_ASEGURAMIENTO_ABRE = case_when(
TIPO_ASEGURAMIENTO == "ASALARIADO" ~ "ASAL",
TIPO_ASEGURAMIENTO == "PENSIONADOS EN SU PROPIO SISTEMA" ~ "PENPS",
TIPO_ASEGURAMIENTO == "ASEGURADO VOLUNTARIO" ~ "VOL",
TIPO_ASEGURAMIENTO == "TRABAJADOR INDEPENDIENTE" ~ "INDEP",
TIPO_ASEGURAMIENTO == "CONVENIOS ESPECIALES DE TRABAJADORES INDEPENDIENTES" ~ "CONV-TI",
TIPO_ASEGURAMIENTO == "CONVENIOS ESPECIALES DE ASEGURADOS VOLUNTARIOS" ~ "CONV-VOL",
TRUE ~ "OTRO"
)
)%>%
mutate(
INDICADOR_MOROSO      = factor(INDICADOR_MOROSO),
SEXO                  = factor(SEXO),
SECTOR                = factor(SECTOR),
INDICADOR_ACTIVO      = factor(INDICADOR_ACTIVO),
INDICADOR.EXTRANJERO  = factor(INDICADOR.EXTRANJERO),
TIPO_ASEGURAMIENTO_ABRE = factor(TIPO_ASEGURAMIENTO_ABRE)
) %>%
select(INDICADOR_MOROSO,          # variable objetivo
SEXO,
SECTOR,
INDICADOR_ACTIVO,
INDICADOR.EXTRANJERO,
TIPO_ASEGURAMIENTO_ABRE,
EDAD,
SALARIO)
tree <- rpart(INDICADOR_MOROSO ~ ., data = moras_arbol, method = "class")
tree <- rpart(INDICADOR_MOROSO ~ ., data = moras.arbol, method = "class")
rpart.plot(
tree,
type = 2,
extra = 104,
under = TRUE,
faclen = 0
)
rpart.plot(
tree)
moras.arbol <- moras %>%
mutate(
TIPO_ASEGURAMIENTO_ABRE = case_when(
TIPO_ASEGURAMIENTO == "ASALARIADO" ~ "ASAL",
TIPO_ASEGURAMIENTO == "PENSIONADOS EN SU PROPIO SISTEMA" ~ "PENPS",
TIPO_ASEGURAMIENTO == "ASEGURADO VOLUNTARIO" ~ "VOL",
TIPO_ASEGURAMIENTO == "TRABAJADOR INDEPENDIENTE" ~ "INDEP",
TIPO_ASEGURAMIENTO == "CONVENIOS ESPECIALES DE TRABAJADORES INDEPENDIENTES" ~ "CONV-TI",
TIPO_ASEGURAMIENTO == "CONVENIOS ESPECIALES DE ASEGURADOS VOLUNTARIOS" ~ "CONV-VOL",
TRUE ~ "OTRO"
)
)
tree <- rpart(INDICADOR_MOROSO ~ ., data = moras.arbol, method = "class")
rpart.plot(
tree)
rpart.plot(
tree)
moras.arbol <- moras %>%
mutate(
TIPO_ASEGURAMIENTO_ABRE = case_when(
TIPO_ASEGURAMIENTO == "ASALARIADO" ~ "ASAL",
TIPO_ASEGURAMIENTO == "PENSIONADOS EN SU PROPIO SISTEMA" ~ "PENPS",
TIPO_ASEGURAMIENTO == "ASEGURADO VOLUNTARIO" ~ "VOL",
TIPO_ASEGURAMIENTO == "TRABAJADOR INDEPENDIENTE" ~ "INDEP",
TIPO_ASEGURAMIENTO == "CONVENIOS ESPECIALES DE TRABAJADORES INDEPENDIENTES" ~ "CONV-TI",
TIPO_ASEGURAMIENTO == "CONVENIOS ESPECIALES DE ASEGURADOS VOLUNTARIOS" ~ "CONV-VOL",
TRUE ~ "OTRO"
)
)
moras.arbol <- moras %>%
mutate(
TIPO_ASEGURAMIENTO_ABRE = case_when(
TIPO_ASEGURAMIENTO == "ASALARIADO" ~ "ASAL",
TIPO_ASEGURAMIENTO == "PENSIONADOS EN SU PROPIO SISTEMA" ~ "PENPS",
TIPO_ASEGURAMIENTO == "ASEGURADO VOLUNTARIO" ~ "VOL",
TIPO_ASEGURAMIENTO == "TRABAJADOR INDEPENDIENTE" ~ "INDEP",
TIPO_ASEGURAMIENTO == "CONVENIOS ESPECIALES DE TRABAJADORES INDEPENDIENTES" ~ "CONV-TI",
TIPO_ASEGURAMIENTO == "CONVENIOS ESPECIALES DE ASEGURADOS VOLUNTARIOS" ~ "CONV-VOL",
TRUE ~ "OTRO"
)
)
tree <- rpart(INDICADOR_MOROSO ~ ., data = moras.arbol, method = "class")
rpart.plot(
tree)
moras.arbol <- moras %>%
mutate(
TIPO_ASEGURAMIENTO_ABRE = case_when(
TIPO_ASEGURAMIENTO == "ASALARIADO" ~ "ASAL",
TIPO_ASEGURAMIENTO == "PENSIONADOS EN SU PROPIO SISTEMA" ~ "PENPS",
TIPO_ASEGURAMIENTO == "ASEGURADO VOLUNTARIO" ~ "VOL",
TIPO_ASEGURAMIENTO == "TRABAJADOR INDEPENDIENTE" ~ "INDEP",
TIPO_ASEGURAMIENTO == "CONVENIOS ESPECIALES DE TRABAJADORES INDEPENDIENTES" ~ "CONV-TI",
TIPO_ASEGURAMIENTO == "CONVENIOS ESPECIALES DE ASEGURADOS VOLUNTARIOS" ~ "CONV-VOL",
TRUE ~ "OTRO"
)
)
tree <- rpart(INDICADOR_MOROSO ~ ., data = moras.arbol)
rpart.plot(
tree)
moras.arbol
moras.arbol <- moras %>%
mutate(
TIPO_ASEGURAMIENTO = case_when(
TIPO_ASEGURAMIENTO == "ASALARIADO" ~ "ASAL",
TIPO_ASEGURAMIENTO == "PENSIONADOS EN SU PROPIO SISTEMA" ~ "PENPS",
TIPO_ASEGURAMIENTO == "ASEGURADO VOLUNTARIO" ~ "VOL",
TIPO_ASEGURAMIENTO == "TRABAJADOR INDEPENDIENTE" ~ "INDEP",
TIPO_ASEGURAMIENTO == "CONVENIOS ESPECIALES DE TRABAJADORES INDEPENDIENTES" ~ "CONV-TI",
TIPO_ASEGURAMIENTO == "CONVENIOS ESPECIALES DE ASEGURADOS VOLUNTARIOS" ~ "CONV-VOL",
TRUE ~ "OTRO"
)
)
tree <- rpart(INDICADOR_MOROSO ~ ., data = moras.arbol)
rpart.plot(
tree)

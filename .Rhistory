minimo.edad = min(EDAD, na.rm = TRUE),
maximo.edad = max(EDAD, na.rm = TRUE),
q1.edad = quantile(EDAD, 0.25, na.rm = TRUE),
q3.edad = quantile(EDAD, 0.75, na.rm = TRUE),
media.salario = mean(SALARIO, na.rm = TRUE),
minimo.salario = min(SALARIO, na.rm = TRUE),
maximo.salario = max(SALARIO, na.rm = TRUE),
q1.salario = quantile(SALARIO, 0.25, na.rm = TRUE),
q3.salario = quantile(SALARIO, 0.75, na.rm = TRUE),
)
mean.salario <- mean(moras$SALARIO, na.rm = TRUE)
mean.edad <- mean(moras$EDAD, na.rm = TRUE)
desviacion.salario <- sd(moras$SALARIO, na.rm = TRUE)
desviacion.edad <- sd(moras$EDAD, na.rm = TRUE)
moras <- moras %>%
mutate(
Z.SALARIO = (SALARIO - mean.salario) / desviacion.salario,
Z.EDAD = (EDAD - mean.edad) / desviacion.edad
) %>%
mutate(
ATIPICO.SALARIO = if_else(abs(Z.SALARIO) > 1.96, "ATIPICO", "NO ATIPICO"),
ATIPICO.EDAD = if_else(abs(Z.EDAD) > 1.96, "ATIPICO", "NO ATIPICO")
)
porcentajes.na <- data.frame(
dato = names(moras)
faltante = colSums(is.na(moras))
porcentajes.na <- data.frame(
dato = names(moras),
faltante = colSums(is.na(moras))
) %>%
mutate(
porcentajes.na = (faltante/5000)* 100
)
porcentajes.na
library(tidyverse)
porcentajes.na
moda.aseguramiento <- moras %>%
group_by(TIPO_ASEGURAMIENTO) %>%
summarise( contador = n()) %>%
arrange(desc(contador)) %>%
head(1)
moda.aseguramiento
moda.aseg <- "ASALARIADO"
moras <- moras %>%
mutate(
EDAD = if_else(is.na(EDAD), mean.edad, Edad),
SALARIO = if_else(is.na(SALARIO), mean.salario, SALARIO),
TIPO_ASEGURAMIENTO = if_else(is.na(TIPO_ASEGURAMIENTO), moda.aseg, TIPO_ASEGURAMIENTO)
)
moras <- moras %>%
mutate(
EDAD = if_else(is.na(EDAD), mean.edad, EDAD),
SALARIO = if_else(is.na(SALARIO), mean.salario, SALARIO),
TIPO_ASEGURAMIENTO = if_else(is.na(TIPO_ASEGURAMIENTO), moda.aseg, TIPO_ASEGURAMIENTO)
)
moda.aseguramiento
moda.aseg <- moda.aseguramiento$TIPO_ASEGURAMIENTO
moda.aseg
library(tidyverse)
moras %>%
group_by(SEXO) %>%
summarise(contador = n()) %>%
ggplot(aes(x = SEXO, y = contador)) +
geom_bar(stat = "identity", fill = "steelblue") +
theme_minimal()
theme_minimal()
graf.cantidadporsexo <- moras %>%
group_by(SEXO) %>%
summarise(contador = n()) %>%
ggplot(aes(x = SEXO, y = contador)) +
geom_bar(stat = "identity", fill = "steelblue") +
labs(title = "Cantidad por sexo", x = "Sexo", y = "Cantidad")+
theme_minimal()
graf.cantidadporsexo
graf.cantidadporaseguramientp <- moras %>%
group_by(TIPO_ASEGURAMIENTO) %>%
summarise(contador = n()) %>%
ggplot(aes(x = TIPO_ASEGURAMIENTO, y = contador)) +
geom_bar(stat = "identity", fill = "steelblue") +
labs(title = "Cantidad por aseguramiento", x = "Aseguramiento", y = "Cantidad")+
theme_minimal()
graf.cantidadporaseguramientp
graf.cantidadporaseguramientp <- moras %>%
group_by(TIPO_ASEGURAMIENTO) %>%
summarise(contador = n()) %>%
ggplot(aes(x = TIPO_ASEGURAMIENTO, y = contador)) +
geom_bar(stat = "identity", fill = "steelblue") +
labs(title = "Cantidad por aseguramiento", x = "Aseguramiento", y = "Cantidad")+
theme_minimal()+
theme(axis.text.x = element_text(angle = 45, hjust = 1))
graf.cantidadporaseguramientp
graf.cantidadporaseguramientp <- moras %>%
group_by(TIPO_ASEGURAMIENTO) %>%
summarise(contador = n()) %>%
ggplot(aes(x = TIPO_ASEGURAMIENTO, y = contador)) +
geom_bar(stat = "identity", fill = "steelblue") +
labs(title = "Cantidad por aseguramiento", x = "Aseguramiento", y = "Cantidad")+
theme_minimal()+
theme(axis.text.x = element_text(angle = 25, hjust = 1))
graf.cantidadporaseguramientp
resumen
graf.cantidadporsector <- moras %>%
group_by(SECTOR) %>%
summarise(contador = n()) %>%
ggplot(aes(x = SECTOR, y = contador)) +
geom_bar(stat = "identity", fill = "steelblue") +
labs(title = "Cantidad por sector", x = "Sector", y = "Cantidad")+
theme_minimal()
graf.cantidadporsector
View(moras)
moras
graf.cantidadporextranjeros<- moras %>%
group_by(INDICADOR.EXTRANJERO) %>%
summarise(contador = n()) %>%
ggplot(aes(x = SECTOR, y = contador)) +
geom_bar(stat = "identity", fill = "steelblue") +
labs(title = "Cantidad por extranjeros", x = "Extranjero", y = "Cantidad")+
theme_minimal()
graf.cantidadporextranjeros
graf.cantidadporextranjeros<- moras %>%
group_by(INDICADOR.EXTRANJERO) %>%
summarise(contador = n()) %>%
ggplot(aes(x = INDICADOR.EXTRANJERO, y = contador)) +
geom_bar(stat = "identity", fill = "steelblue") +
labs(title = "Cantidad por extranjeros", x = "Extranjero", y = "Cantidad")+
theme_minimal()
graf.cantidadporextranjeros
moras
graf.cantidadporactividad <- moras %>%
group_by(INDICADOR_ACTIVO) %>%
summarise(contador = n()) %>%
ggplot(aes(x = INDICADOR_ACTIVO, y = contador)) +
geom_bar(stat = "identity", fill = "steelblue") +
labs(title = "Cantidad por actividad", x = "Activo", y = "Cantidad")+
theme_minimal()
graf.cantidadporactividad
graf.cantidadpormorosidad <- moras %>%
group_by(INDICADOR_MOROSO) %>%
summarise(contador = n()) %>%
ggplot(aes(x = INDICADOR_MOROSO, y = contador)) +
geom_bar(stat = "identity", fill = "steelblue") +
labs(title = "Cantidad por morosidad", x = "Moroso", y = "Cantidad")+
theme_minimal()
graf.cantidadpormorosidad
graf.cantidadporaseguramientp <- moras %>%
group_by(TIPO_ASEGURAMIENTO) %>%
summarise(contador = n()) %>%
ggplot(aes(x = TIPO_ASEGURAMIENTO, y = contador)) +
coord_flip()+
geom_bar(stat = "identity", fill = "steelblue") +
labs(title = "Cantidad por aseguramiento", x = "Aseguramiento", y = "Cantidad")+
theme_minimal()+
theme(axis.text.x = element_text(angle = 25, hjust = 1))
graf.cantidadporaseguramientp
graf.cantidadporsexo
graf.cantidadporaseguramiento <- moras %>%
group_by(TIPO_ASEGURAMIENTO) %>%
summarise(contador = n()) %>%
ggplot(aes(x = TIPO_ASEGURAMIENTO, y = contador)) +
coord_flip()+
geom_bar(stat = "identity", fill = "steelblue") +
labs(title = "Cantidad por aseguramiento", x = "Aseguramiento", y = "Cantidad")+
theme_minimal()+
theme(axis.text.x = element_text(angle = 25, hjust = 1))
tidyverse
library(tidyverse)
graf.porcentajemorosidad <- function(data, categoria){
data %>%
group_by(.data[[categoria]]) %>%
summarise(
cantidad = n(),
morosos = sum(INDICADOR_MOROSO == "SI"),
porcentaje = morosos / cantidad
) %>%
ggplot(aes(x = .data[[categoria]], y = porcentaje))+
geom_bar(stat = "identify", fill = darkred)+
labs(title = paste("% de morosos por", categoria), x = categoria, y = "Porcentaje")
}
data %>%
group_by(.data[[categoria]]) %>%
summarise(
cantidad = n(),
morosos = sum(INDICADOR_MOROSO == "SI"),
porcentaje = morosos / cantidad
) %>%
ggplot(aes(x = .data[[categoria]], y = porcentaje))+
geom_bar(stat = "identify", fill = "steelblue")+
labs(title = paste("% de morosos por", categoria), x = categoria, y = "Porcentaje")
library(tidyverse)
data %>%
group_by(.data[[categoria]]) %>%
summarise(
cantidad = n(),
morosos = sum(INDICADOR_MOROSO == "SI"),
porcentaje = morosos / cantidad
) %>%
ggplot(aes(x = .data[[categoria]], y = porcentaje))+
geom_bar(stat = "identify", fill = "steelblue")+
labs(title = paste("% de morosos por", categoria), x = categoria, y = "Porcentaje")
graf.porcentajemorosidad <- function(data, categoria){
data %>%
group_by(.data[[categoria]]) %>%
summarise(
cantidad = n(),
morosos = sum(INDICADOR_MOROSO == "SI"),
porcentaje = morosos / cantidad
) %>%
ggplot(aes(x = .data[[categoria]], y = porcentaje))+
geom_bar(stat = "identify", fill = "steelblue")+
labs(title = paste("% de morosos por", categoria), x = categoria, y = "Porcentaje")
}
graf.porcentajemorosidad(moras, SEXO)
graf.porcentajemorosidad(moras, "SEXO")
graf.porcentajemorosidad <- function(data, categoria){
data %>%
group_by(.data[[categoria]]) %>%
summarise(
cantidad = n(),
morosos = sum(INDICADOR_MOROSO == "SI"),
porcentaje = morosos / cantidad
) %>%
ggplot(aes(x = .data[[categoria]], y = porcentaje))+
geom_bar(stat = "identity", fill = "steelblue")+
labs(title = paste("% de morosos por", categoria), x = categoria, y = "Porcentaje")+
geom_text(aes(label = percent(porcentaje, accuracy = 0.1)),
vjust = -0.5,
size = 4) +
scale_y_continuous(labels = percent_format(accuracy = 1),
limits = c(0, max(datos$porcentaje)*1.15)) +
theme_minimal()
}
graf.porcentajemorosidad(moras, "SEXO")
graf.porcentajemorosidad <- function(data, categoria){
data %>%
group_by(.data[[categoria]]) %>%
summarise(
cantidad = n(),
morosos = sum(INDICADOR_MOROSO == "SI"),
porcentaje = morosos / cantidad
) %>%
ggplot(aes(x = .data[[categoria]], y = porcentaje))+
geom_bar(stat = "identity", fill = "steelblue")+
labs(title = paste("% de morosos por", categoria), x = categoria, y = "Porcentaje") +
theme_minimal()
}
graf.porcentajemorosidad(moras, "SEXO")
graf.porcentajemorosidad(moras, "TIPO_ASEGURAMIENTO")
library(scales)
ggplot(datos_aseg, aes(x = porcentaje, y = TIPO_ASEGURAMIENTO)) +
geom_col(fill = "steelblue") +
geom_text(aes(label = percent(porcentaje, accuracy = 0.1)),
hjust = -0.1, size = 4) +
scale_x_continuous(labels = percent_format(accuracy = 1),
limits = c(0, max(datos_aseg$porcentaje) * 1.15)) +
labs(title = "% de morosos por tipo de aseguramiento",x = "Porcentaje",y = "Tipo de aseguramiento"
) +
theme_minimal()
ggplot(datos_aseg, aes(x = porcentaje, y = TIPO_ASEGURAMIENTO)) +
geom_col(fill = "steelblue") +
geom_text(aes(label = percent(porcentaje, accuracy = 0.1)),
hjust = -0.1, size = 4)+
labs(title = "% de morosos por tipo de aseguramiento",x = "Porcentaje",y = "Tipo de aseguramiento"
) +
theme_minimal()
porcentaje.morosos.aseguramiento <- moras %>%
group_by(TIPO_ASEGURAMIENTO) %>%
summarise(
cantidad = n(),
morosos = sum(INDICADOR_MOROSO == "SI"),
porcentaje = morosos / cantidad
)+
ggplot(datos_aseg, aes(x = porcentaje, y = TIPO_ASEGURAMIENTO)) +
geom_col(fill = "steelblue") +
geom_text(aes(label = percent(porcentaje, accuracy = 0.1)),
hjust = -0.1, size = 4)+
labs(title = "% de morosos por tipo de aseguramiento",x = "Porcentaje",y = "Tipo de aseguramiento"
) +
theme_minimal()
distribucion.aseg <- moras %>%
group_by(TIPO_ASEGURAMIENTO) %>%
summarise(
cantidad = n(),
morosos = sum(INDICADOR_MOROSO == "SI"),
porcentaje = morosos / cantidad
)
ggplot(distribucion.aseg, aes(x = porcentaje, y = TIPO_ASEGURAMIENTO)) +
geom_col(fill = "steelblue") +
geom_text(aes(label = percent(porcentaje, accuracy = 0.1)),
hjust = -0.1, size = 4)+
labs(title = "% de morosos por tipo de aseguramiento",x = "Porcentaje",y = "Tipo de aseguramiento"
) +
theme_minimal()
ggplot(distribucion.aseg, aes(x = porcentaje, y = TIPO_ASEGURAMIENTO)) +
geom_col(fill = "steelblue") +
geom_text(aes(label = percent(porcentaje, accuracy = 0.1)),
hjust = -0.1, size = 4) +
scale_x_continuous(labels = percent_format(accuracy = 1),
limits = c(0, max(distribucion.aseg$porcentaje) * 1.15)) +
labs(
title = "% de morosos por tipo de aseguramiento",
x = "Porcentaje",
y = "Tipo de aseguramiento"
) +
theme_minimal()
graf.porcentajemorosidad(moras, "INDICADOR_ACTIVO")
graf.porcentajemorosidad <- function(data, categoria){
data %>%
group_by(.data[[categoria]]) %>%
summarise(
cantidad = n(),
morosos = sum(INDICADOR_MOROSO == "SI"),
porcentaje = morosos / cantidad
) %>%
ggplot(aes(x = .data[[categoria]], y = porcentaje))+
geom_bar(stat = "identity", fill = "steelblue")+
labs(title = paste("% de morosos por", categoria), x = categoria, y = "Porcentaje") +
theme_minimal()+
}
graf.porcentajemorosidad <- function(data, categoria){
data %>%
group_by(.data[[categoria]]) %>%
summarise(
cantidad = n(),
morosos = sum(INDICADOR_MOROSO == "SI"),
porcentaje = morosos / cantidad
)
geom_text(aes(label = percent(porcentaje, accuracy = 0.1)), vjust = -0.5, size = 4) +
scale_y_continuous(labels = percent_format(accuracy = 1),
limits = c(0, max(datos$porcentaje)*1.15)) +
labs( title = paste("% de morosos por", categoria), x = categoria, y = "Porcentaje"
) +
theme_minimal()
}
graf.porcentajemorosidad(moras, "SEXO")
graf.porcentajemorosidad <- function(data, categoria){
data %>%
group_by(.data[[categoria]]) %>%
summarise(
cantidad = n(),
morosos = sum(INDICADOR_MOROSO == "SI"),
porcentaje = morosos / cantidad
) %>% geom_text(aes(label = percent(porcentaje, accuracy = 0.1)), vjust = -0.5, size = 4) +
scale_y_continuous(labels = percent_format(accuracy = 1),
limits = c(0, max(datos$porcentaje)*1.15)) +
labs( title = paste("% de morosos por", categoria), x = categoria, y = "Porcentaje"
) +
theme_minimal()
}
graf.porcentajemorosidad(moras, "SEXO")
graf.porcentajemorosidad <- function(data, categoria){
datos <- data %>%
group_by(.data[[categoria]]) %>%
summarise(
cantidad   = n(),
morosos    = sum(INDICADOR_MOROSO == "SI"),
porcentaje = morosos / cantidad
)
ggplot(datos, aes(x = .data[[categoria]], y = porcentaje)) +
geom_col(fill = "steelblue") +
geom_text(aes(label = percent(porcentaje, accuracy = 0.1)),
vjust = -0.5, size = 4) +
scale_y_continuous(labels = percent_format(accuracy = 1),
limits = c(0, max(datos$porcentaje) * 1.15)) +
labs( title = paste("% de morosos por", categoria), x = categoria,y = "Porcentaje"
) +
theme_minimal()
}
graf.porcentajemorosidad(moras, "SEXO")
ggplot(distribucion.aseg, aes(x = porcentaje, y = TIPO_ASEGURAMIENTO)) +
geom_col(fill = "steelblue") +
geom_text(aes(label = percent(porcentaje, accuracy = 0.1)),
hjust = -0.1, size = 4) +
scale_x_continuous(labels = percent_format(accuracy = 1),
limits = c(0, max(distribucion.aseg$porcentaje) * 1.15)) +
labs(title = "% de morosos por tipo de aseguramiento",x = "Porcentaje",y = "Tipo de aseguramiento"
) +
theme_minimal()
graf.porcentajemorosidad(moras, "SEXO")
graf.porcentajemorosidad(moras, "INDICADOR_ACTIVO")
graf.porcentajemorosidad(moras, "INDICADOR.EXTRANJERO")
graf.porcentajemorosidad(moras, "SECTOR")
ggplot(distribucion.aseg, aes(x = porcentaje, y = TIPO_ASEGURAMIENTO)) +
geom_col(fill = "steelblue") +
geom_text(aes(label = percent(porcentaje, accuracy = 0.1)),
hjust = -0.1, size = 4) +
scale_x_continuous(labels = percent_format(accuracy = 1),
limits = c(0, max(distribucion.aseg$porcentaje) * 1.15)) +
labs(title = "% de morosos por tipo de aseguramiento",x = "Porcentaje",y = "Tipo de aseguramiento"
) +
theme_minimal()
moras
ggplot(moras, aes(x = INDICADOR_MOROSO, y = SALARIO, fill = INDICADOR_MOROSO)) +
geom_boxplot() +
labs(
title = "Distribución del salario según morosidad",
x = "Moroso",
y = "Salario"
) +
theme_minimal() +
theme(legend.position = "none")
library(tidyverse)
ggplot(moras, aes(x = INDICADOR_MOROSO, y = SALARIO, fill = INDICADOR_MOROSO)) +
geom_boxplot() +
labs(
title = "Distribución del salario según morosidad",
x = "Moroso",
y = "Salario"
) +
theme_minimal() +
theme(legend.position = "none")
resumen
moras <- moras %>%
mutate(
RANGO.EDAD = case_when(
EDAD >= 14 & EDAD <= 24 ~ "14-24",
EDAD >= 25 & EDAD <= 34 ~ "25-34",
EDAD >= 35 & EDAD <= 44 ~ "35-44",
EDAD >= 45 & EDAD <= 54 ~ "45-54",
EDAD >= 55 & EDAD <= 64 ~ "55-64",
EDAD >= 65              ~ "65+",
TRUE ~ NA_character_
)
)
moras
moras <- moras %>%
mutate(
RANGO_SALARIO = case_when(
SALARIO >= 0       & SALARIO < 200000  ~ "0-200k",
SALARIO >= 200000  & SALARIO < 400000  ~ "200k-400k",
SALARIO >= 400000  & SALARIO < 800000  ~ "400k-800k",
SALARIO >= 800000  & SALARIO < 1500000 ~ "800k-1.5M",
SALARIO >= 1500000 & SALARIO < 3000000 ~ "1.5M-3M",
SALARIO >= 3000000                     ~ "3M+",
TRUE ~ NA_character_
)
)
edad.totales <- moras %>%
group_by(RANGO.EDAD, INDICADOR_MOROSO) %>%
summarise(cantidad = n(), .groups = "drop")
edad.totales
edad.totales <- moras %>%
group_by(RANGO.EDAD, INDICADOR_MOROSO) %>%
summarise(cantidad = n())
edad.totales <- moras %>%
group_by(RANGO.EDAD, INDICADOR_MOROSO) %>%
summarise(cantidad = n(), .groups = "drop")
edad.totales
ggplot(edad_totales, aes(x = RANGO_EDAD, y = cantidad, fill = INDICADOR_MOROSO)) +
geom_col(position = "dodge") +
labs(
title = "Cantidad de morosos y no morosos por rango de edad",
x = "Rango de edad",
y = "Cantidad",
fill = "Moroso"
) +
scale_fill_manual(values = c("SI" = "firebrick", "NO" = "steelblue")) +
theme_minimal()
ggplot(edad.totales, aes(x = RANGO,EDAD, y = cantidad, fill = INDICADOR_MOROSO)) +
geom_col(position = "dodge") +
labs(
title = "Cantidad de morosos y no morosos por rango de edad",
x = "Rango de edad",
y = "Cantidad",
fill = "Moroso"
) +
scale_fill_manual(values = c("SI" = "firebrick", "NO" = "steelblue")) +
theme_minimal()
ggplot(edad.totales, aes(x = RANGO.EDAD, y = cantidad, fill = INDICADOR_MOROSO)) +
geom_col(position = "dodge") +
labs(
title = "Cantidad de morosos y no morosos por rango de edad",
x = "Rango de edad",
y = "Cantidad",
fill = "Moroso"
) +
scale_fill_manual(values = c("SI" = "firebrick", "NO" = "steelblue")) +
theme_minimal()
ggplot(edad.totales, aes(x = RANGO.EDAD, y = cantidad, fill = INDICADOR_MOROSO)) +
geom_col(position = "dodge") +
labs(
title = "Cantidad de morosos y no morosos por rango de edad", x = "Rango de edad", y = "Cantidad",
fill = "Moroso"
) +
scale_fill_manual(values = c("SI" = "#D6A3F0", "NO" = "steelblue")) +
theme_minimal()
ggplot(edad.totales, aes(x = RANGO.EDAD, y = cantidad, fill = INDICADOR_MOROSO)) +
geom_col(position = "dodge") +
labs(
title = "Cantidad de morosos y no morosos por rango de edad", x = "Rango de edad", y = "Cantidad",
fill = "Moroso"
) +
scale_fill_manual(values = c("SI" = "#D6A3F0", "NO" = "#309C58")) +
theme_minimal()
ggplot(edad.totales, aes(x = RANGO.EDAD, y = cantidad, fill = INDICADOR_MOROSO)) +
geom_col(position = "dodge") +
labs(
title = "Cantidad de morosos y no morosos por rango de edad", x = "Rango de edad", y = "Cantidad",
fill = "Moroso"
) +
scale_fill_manual(values = c("SI" = "#B8291D", "NO" = "#309C58")) +
theme_minimal()
salarios.totales <- moras %>%
group_by(RANGO_SALARIO, INDICADOR_MOROSO) %>%
summarise(cantidad = n(), .groups = "drop")
ggplot(salarios.totales, aes(x = RANGO_SALARIO, y = cantidad, fill = INDICADOR_MOROSO)) +
geom_col(position = "dodge") +
labs(
title = "Cantidad de morosos y no morosos por rango salarial", x = "Rango salarial", y = "Cantidad",
fill = "Moroso"
) +
scale_fill_manual(values = c("SI" = "#B8291D", "NO" = "#309C58")) +
theme_minimal()
